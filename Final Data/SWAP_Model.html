<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zehaan Naik">

<title>SWAP Model Fit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SWAP_Model_files/libs/clipboard/clipboard.min.js"></script>
<script src="SWAP_Model_files/libs/quarto-html/quarto.js"></script>
<script src="SWAP_Model_files/libs/quarto-html/popper.min.js"></script>
<script src="SWAP_Model_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SWAP_Model_files/libs/quarto-html/anchor.min.js"></script>
<link href="SWAP_Model_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SWAP_Model_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SWAP_Model_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SWAP_Model_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SWAP_Model_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SWAP Model Fit</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zehaan Naik </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="breaking-point" class="level2">
<h2 class="anchored" data-anchor-id="breaking-point">Breaking Point</h2>
<p>Now that we have finalised the data and checked for bi-directional causality, we now attempt to fit a SWAP model on the data. First we load and observe the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat.gold <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"GoldUP.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>CPI.dat <span class="ot">&lt;-</span> dat.gold<span class="sc">$</span>CPI</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>SENSEX.dat <span class="ot">&lt;-</span> dat.gold<span class="sc">$</span>Sensex</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>CPI.dat <span class="ot">&lt;-</span> <span class="fu">ts</span>(CPI.dat, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">10</span>),  <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>SENSEX.dat <span class="ot">&lt;-</span> <span class="fu">ts</span>(SENSEX.dat, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">10</span>),  <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising the data </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(CPI.dat, <span class="at">main =</span> <span class="st">"CPI"</span>, <span class="at">ylab =</span> <span class="st">"CPI"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(SENSEX.dat, <span class="at">main =</span> <span class="st">"SENSEX"</span>, <span class="at">ylab =</span> <span class="st">"SENSEX"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observing the trend in the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CPI.dat, SENSEX.dat, <span class="at">main =</span> <span class="st">"CPI vs SENSEX Scatter Plot"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"CPI"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"SENSEX"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, we need to establish a mechanism through which we make a division on the plane that gives us the two domains where CPI and SENSEX can take the role of being the predictors respectively. One way to do this is through the Chow test as discussed in the other data set.</p>
<p>Three problems that we observe with this approach are:</p>
<ol type="1">
<li><p>This method is very computationally intensive as it requires us to fit a regression model for each choice of the breaking point <span class="math inline">\(d\)</span> and it’s convergence is based on the assumption that the increments in <span class="math inline">\(d\)</span> are not infinitely small.</p></li>
<li><p>The convergence is not stable for the L2 model and hence we need to rely on some other method to figure out the break point anyways.</p></li>
<li><p>The way the Chow test is structured forces us to have a hard decision boundary based on one of the coordinates in the data. For example, in our current data the best Chow test can divide the data is all points such that <span class="math inline">\(X &lt; X_\text{breakingpoint}\)</span>. This means that we cannot have a cluster type of classification using this approach, something that SWAP paradigm need not prohibit.</p></li>
</ol>
<p>These three issues coupled with the fact that Chow test to determine the break point is not problem agnostic, motivates us to consider an alternative method to find a natural breaking point.</p>
<section id="the-gaussian-mixture-model" class="level3">
<h3 class="anchored" data-anchor-id="the-gaussian-mixture-model">The Gaussian Mixture Model</h3>
<p>I propose we use the Gaussian Mixture Model approach to cluster our data into 2 groups with a similar linear trend. To accomplish this I use the Mahalanobis distance in the standard GMM algorithm as it is characteristic of identifying linear patterns in data.</p>
<p>The exact code that details my approach to this is available in GMM.R.</p>
<p>The results after the split looks like these:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"GMM.R"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(CPI.dat),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(SENSEX.dat)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">2</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>gmm_result <span class="ot">&lt;-</span> <span class="fu">gmm_em_mahalanobis</span>(data, K)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data, <span class="at">col =</span> gmm_result<span class="sc">$</span>clusters, <span class="at">main =</span> <span class="st">"Modified GMM Clusters"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"CPI"</span>, <span class="at">ylab =</span> <span class="st">"SENSEX"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Cluster - 1"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Cluster - 2"</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"coral"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can compare this result with the Chow test as well:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the strucchange package</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'strucchange' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sandwich</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sandwich' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the break point</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>breakpoint_final <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>min_val <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (breakpoint <span class="cf">in</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">150</span>){</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform the Chow test</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  chow_test <span class="ot">&lt;-</span> <span class="fu">sctest</span>(SENSEX.dat <span class="sc">~</span> CPI.dat, <span class="at">type =</span> <span class="st">"Chow"</span>, <span class="at">point =</span> breakpoint)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (chow_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> min_val){</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    min_val <span class="ot">&lt;-</span> chow_test<span class="sc">$</span>p.value</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    breakpoint_final <span class="ot">&lt;-</span> breakpoint</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data, <span class="at">col =</span> <span class="fu">as.factor</span>(CPI.dat<span class="sc">&lt;</span>breakpoint_final), <span class="at">main =</span> <span class="st">"Chow Test Clusters"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"CPI"</span>, <span class="at">ylab =</span> <span class="st">"SENSEX"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Cluster - 2"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Cluster - 1"</span>),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"coral"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We observe that the Chow test does not give us the break in pattern that we would want for the SWAP model and hence, we go ahead with the GMM clusters.</p>
</section>
<section id="l1-norm-optimisation" class="level3">
<h3 class="anchored" data-anchor-id="l1-norm-optimisation">L1 Norm Optimisation</h3>
<p>Finally, let’s fit the SWAP models on the data set. First we fit the L1 norm optimisation model.</p>
<p>The “fit function” remains the constant for either of the models:</p>
<p><span class="math display">\[
y = g(x) = ax^2 + bx + c\\
x = g^{-1}(y) = \dfrac{-b \pm \sqrt{b^2 - 4a(c-y)}}{2a}
\]</span>And, we wish to find the estimators for <span class="math inline">\(a, b\)</span> and <span class="math inline">\(c\)</span> that minimise the loss function:</p>
<p><span class="math display">\[
\mathcal{L} = \sum_{i \in \mathcal{I}} I(Z_i = 0) \left|Y_i - g(X_i)\right| + I(Z_i = 1) \left|X_i - g^{-1}(Y_i)\right|
\]</span></p>
<p>We use gradient descent to achieve the same and here is the final algorithm:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To be estimated</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyper Parameters</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">150</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">=</span> <span class="fl">1e-4</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CPI.dat)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SENSEX.dat)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># part - 1</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> Y[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># part - 2</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> X[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">2</span>)]</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> Y[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">2</span>)]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Auxilliary Derrivative funcitons</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>der_a <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)){</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Y[i]<span class="sc">-</span>(a<span class="sc">*</span>X[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X[i] <span class="sc">+</span> c) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">-</span>  X[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">+</span>   X[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ret<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>der_b <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)){</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Y[i]<span class="sc">-</span>(a<span class="sc">*</span>X[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X[i] <span class="sc">+</span> c) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">-</span>  X[i]</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">+</span>   X[i]</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ret<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>der_c <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)){</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Y[i]<span class="sc">-</span>(a<span class="sc">*</span>X[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X[i] <span class="sc">+</span> c) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">-</span>  <span class="dv">1</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">+</span>   <span class="dv">1</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ret<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster - 1</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  a_n <span class="ot">&lt;-</span> a <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_a</span>(X1,Y1,a,b,c)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>  b_n <span class="ot">&lt;-</span> b <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_b</span>(X1,Y1,a,b,c)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>  c_n <span class="ot">&lt;-</span> c <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_c</span>(X1,Y1,a,b,c)</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> a_n</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> b_n</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> c_n</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse of Auxilliary Functions</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>der_inv_a <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)){</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>    sqrt_term <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])))</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(X[i]<span class="sc">+</span>((b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)) <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">-</span>  b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="sc">-</span>b <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sqrt_term <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])<span class="sc">/</span>sqrt_term)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">+</span>  b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="sc">-</span>b <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sqrt_term <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])<span class="sc">/</span>sqrt_term)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ret<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>der_inv_b <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)){</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>    sqrt_term <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])))</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(X[i]<span class="sc">+</span>((b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)) <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">+</span>  (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a))<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> b<span class="sc">/</span>(a<span class="sc">*</span>sqrt_term))</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">-</span>  (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a))<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> b<span class="sc">/</span>(a<span class="sc">*</span>sqrt_term))</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ret<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>der_inv_c <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)){</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>    sqrt_term <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])))</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(X[i]<span class="sc">+</span>((b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)) <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y[i])))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">+</span>  (<span class="dv">1</span><span class="sc">/</span>sqrt_term)</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> ret <span class="sc">-</span>  (<span class="dv">1</span><span class="sc">/</span>sqrt_term)</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ret<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster - 2</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>  a_n <span class="ot">&lt;-</span> a <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_inv_a</span>(X2,Y2,a,b,c)</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>  b_n <span class="ot">&lt;-</span> b <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_inv_b</span>(X2,Y2,a,b,c)</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>  c_n <span class="ot">&lt;-</span> c <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_inv_c</span>(X2,Y2,a,b,c)</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> a_n</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> b_n</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> c_n</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>p1y <span class="ot">&lt;-</span> a<span class="sc">*</span>X1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X1 <span class="sc">+</span> c</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>p2x <span class="ot">&lt;-</span> <span class="sc">-</span>b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a) <span class="sc">+</span> <span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c <span class="sc">-</span> Y2))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">xlab =</span> <span class="st">"CPI"</span>, <span class="at">ylab =</span> <span class="st">"SENSEX"</span>, <span class="at">main =</span> <span class="st">"L1 Norm Optimisation"</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">col =</span> gmm_result<span class="sc">$</span>clusters)</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(X1),<span class="fu">as.numeric</span>(p1y),<span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(p2x),<span class="fu">as.numeric</span>(Y2),<span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample code to add a legend with lines instead of boxes</span></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Half run"</span>, <span class="st">"Full run"</span>, <span class="st">"Cluster - 1"</span>, <span class="st">"Cluster - 2"</span>), </span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"pink"</span>), </span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),         <span class="co"># Line type for Half and Full run, NA for clusters</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>),         <span class="co"># Symbols for clusters only</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)                       <span class="co"># Line width for Half and Full run lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"a = "</span>,a,<span class="st">"b = "</span>,b,<span class="st">"c = "</span>,c))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a =  2.6166780791693 b =  0.0201341736689 c =  0.999170610862786"</code></pre>
</div>
</div>
<p>Finally, we want to observe the residuals of this model fitting:</p>
<p>One detail that we need to observe here, we need to compute the residuals for the data carefully. In on region of our data, <span class="math inline">\(X\)</span> is the predictor for <span class="math inline">\(Y\)</span> and the other way round for cluster 2. Hence, the residuals would be based on <span class="math inline">\(Y\)</span> in cluster-1 and <span class="math inline">\(X\)</span> in cluster-2.</p>
<p>Another problem is that the scale of the data need not be the same and hence, we need to scale the errors if we want to observe the true pattern in the residuals like in a normal regression set-up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing residuals</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>residuals1 <span class="ot">&lt;-</span> <span class="fu">scale</span>(Y1 <span class="sc">-</span> p1y)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>residuals2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(X2 <span class="sc">-</span> p2x)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>residuals_L1_norm <span class="ot">&lt;-</span> <span class="fu">c</span>(residuals1, residuals2)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean of residuals - extremely close to 0</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(residuals_L1_norm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.434095e-18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To observe if there is an underlying pattern</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(residuals_L1_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test for stationarity</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tseries' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(residuals_L1_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  residuals_L1_norm
Dickey-Fuller = -2.8403, Lag order = 6, p-value = 0.2225
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Much better result than compared to any of the previous models</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrary to our previous experiments, we observe that the residuals that we get for this model are much closer to being stationary.</p>
</section>
<section id="l2-norm-optimisation" class="level3">
<h3 class="anchored" data-anchor-id="l2-norm-optimisation">L2 Norm Optimisation</h3>
<p>We proceed with the same “fit function” <span class="math inline">\(g\)</span> as described in the last section however, we now look at a L2 type of loss function defined as:</p>
<p><span class="math display">\[
\mathcal{L} = \sum_{i \in \mathcal{I}} I(Z_i = 0) \left[Y_i - g(X_i)\right]^2 + I(Z_i = 1) \left[X_i - g^{-1}(Y_i)\right]^2
\]</span></p>
<p>This changes our derrivatives for estimating the parameters, however, the rest of the model remains exactly the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To be estimated</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyper Parameters</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">70</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">=</span> <span class="fl">1e-9</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CPI.dat)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SENSEX.dat)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># part - 1</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> Y[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># part - 2</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> X[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">2</span>)]</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> Y[<span class="fu">which</span>(gmm_result<span class="sc">$</span>clusters <span class="sc">==</span> <span class="dv">2</span>)]</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Auxilliary Derrivative funcitons</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>der_a <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> (Y<span class="sc">-</span>(a<span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X <span class="sc">+</span> c))<span class="sc">*</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loss)<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>der_b <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> (Y<span class="sc">-</span>(a<span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X <span class="sc">+</span> c))<span class="sc">*</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>X)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loss)<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>der_c <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> (Y<span class="sc">-</span>(a<span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X <span class="sc">+</span> c))<span class="sc">*</span>(<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loss)<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster - 1</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  a_n <span class="ot">&lt;-</span> a <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_a</span>(X1,Y1,a,b,c)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  b_n <span class="ot">&lt;-</span> b <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_b</span>(X1,Y1,a,b,c)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  c_n <span class="ot">&lt;-</span> c <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_c</span>(X1,Y1,a,b,c)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> a_n</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> b_n</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> c_n</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse of Auxilliary Functions</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>der_inv_a <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> (X <span class="sc">-</span> (<span class="sc">-</span>b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a) <span class="sc">+</span> <span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)))<span class="sc">*</span>(b <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y)<span class="sc">/</span><span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y)) <span class="sc">-</span> <span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y)))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loss)<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>der_inv_b <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> (X <span class="sc">-</span> (<span class="sc">-</span>b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a) <span class="sc">+</span> <span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)))<span class="sc">*</span>(b<span class="sc">/</span><span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y)) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loss)<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>der_inv_c <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y,a,b,c){</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> (Y<span class="sc">-</span>(a<span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X <span class="sc">+</span> c))<span class="sc">*</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c<span class="sc">-</span>Y)))</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loss)<span class="sc">/</span><span class="fu">length</span>(X))</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster - 2</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  a_n <span class="ot">&lt;-</span> a <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_inv_a</span>(X2,Y2,a,b,c)</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  b_n <span class="ot">&lt;-</span> b <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_inv_b</span>(X2,Y2,a,b,c)</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  c_n <span class="ot">&lt;-</span> c <span class="sc">-</span> lr<span class="sc">*</span><span class="fu">der_inv_c</span>(X2,Y2,a,b,c)</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> a_n</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> b_n</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> c_n</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>p1y <span class="ot">&lt;-</span> a<span class="sc">*</span>X1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>X1 <span class="sc">+</span> c</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>p2x <span class="ot">&lt;-</span> <span class="sc">-</span>b<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a) <span class="sc">+</span> <span class="fu">sqrt</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>a<span class="sc">*</span>(c <span class="sc">-</span> Y2))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">xlab =</span> <span class="st">"CPI"</span>, <span class="at">ylab =</span> <span class="st">"SENSEX"</span>, <span class="at">main =</span> <span class="st">"L2 Norm Optimisation"</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">col =</span> gmm_result<span class="sc">$</span>clusters)</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(X1),<span class="fu">as.numeric</span>(p1y),<span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(p2x),<span class="fu">as.numeric</span>(Y2),<span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample code to add a legend with lines instead of boxes</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Half run"</span>, <span class="st">"Full run"</span>, <span class="st">"Cluster - 1"</span>, <span class="st">"Cluster - 2"</span>), </span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"pink"</span>), </span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),         <span class="co"># Line type for Half and Full run, NA for clusters</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>),         <span class="co"># Symbols for clusters only</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)                       <span class="co"># Line width for Half and Full run lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"a = "</span>,a,<span class="st">"b = "</span>,b,<span class="st">"c = "</span>,c))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a =  2.66809320579757 b =  0.0470135034079921 c =  1.00085458885729"</code></pre>
</div>
</div>
<p>Performing the similar residual analysis as we did for the previous section, here are the final results that we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing residuals</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>residuals1 <span class="ot">&lt;-</span> <span class="fu">scale</span>(Y1 <span class="sc">-</span> p1y)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>residuals2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(X2 <span class="sc">-</span> p2x)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>residuals_L2_norm <span class="ot">&lt;-</span> <span class="fu">c</span>(residuals1, residuals2)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean of residuals - extremely close to 0</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(residuals_L2_norm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.612422e-17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To observe if there is an underlying pattern</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(residuals_L2_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SWAP_Model_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test for stationarity</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(residuals_L2_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  residuals_L2_norm
Dickey-Fuller = -2.837, Lag order = 6, p-value = 0.2239
alternative hypothesis: stationary</code></pre>
</div>
</div>
</section>
<section id="comparing-the-two-loss-functions" class="level3">
<h3 class="anchored" data-anchor-id="comparing-the-two-loss-functions">Comparing the Two Loss Functions</h3>
<p>Now that we have two fits, we wish to compare the two residuals on some standard tests for regression.</p>
<ol type="1">
<li>Sum of errors:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum of Squared Errors</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(residuals_L1_norm<span class="sc">^</span><span class="dv">2</span>) <span class="co"># L1 Norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 237</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(residuals_L2_norm<span class="sc">^</span><span class="dv">2</span>) <span class="co"># L2 Norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 237</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum of Abs Errors</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(residuals_L1_norm)) <span class="co"># L1 Norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 197.9957</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(residuals_L2_norm)) <span class="co"># L2 Norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 197.4567</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We onbserve that the sum of errors on these models is very close to each other</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>